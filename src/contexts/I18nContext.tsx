/* eslint-disable react-refresh/only-export-components */
import React, { createContext, useContext, useEffect, useMemo, useState } from 'react';

type Locale = 'en' | 'es' | 'fr';

type TranslationMap = Record<Locale, Record<string, string>>;

const translations: TranslationMap = {
    en: {
        'common.appName': 'OryxenTech Collateral Loans',
        'common.shortName': 'OryxenTech',
        'common.languageLabel': 'Language',
        'common.logout': 'Logout',
        'common.loading': 'Loading...',
        'common.save': 'Save',
        'common.cancel': 'Cancel',
        'common.submit': 'Submit',
        'common.approve': 'Approve',
        'common.reject': 'Reject',
        'common.view': 'View',
        'common.error.generic': 'Something went wrong. Please try again.',
        'common.storage.disabled': 'File uploads are disabled in this environment. Provide text evidence instead.',
        'common.status.active': 'Active',
        'common.status.pending': 'Pending',
        'common.status.rejected': 'Rejected',
        'common.status.approved': 'Approved',
        'common.status.submitted': 'Submitted',
        'common.status.confirmed': 'Confirmed',
        'common.status.underReview': 'Under review',
        'nav.dashboard': 'Dashboard',
        'nav.identity': 'Identity',
        'nav.collateral': 'Collateral',
        'nav.loans': 'Loans',
        'nav.payments': 'Payments',
        'nav.help': 'Help',
        'nav.requests': 'Requests',
        'nav.settings': 'Settings',
        'nav.audit': 'Audit',
        'nav.admin': 'Admin',
        'nav.customer': 'Customer',

        'landing.title': 'Fast, secure collateral-backed loans',
        'landing.subtitle':
            'Request short-term funding by leaving approved devices as collateral. Transparent, auditable, and secure.',
        'landing.cta.apply': 'Apply now',
        'landing.cta.login': 'Login',
        'landing.feature.fast': 'Rapid review within 24 hours',
        'landing.feature.secure': 'Bank-grade security and clear audit trails',
        'landing.feature.rates': 'Competitive rates and clear repayment plans',
        'landing.step.register': 'Register',
        'landing.step.kyc': 'Verify identity',
        'landing.step.request': 'Request loan',
        'landing.step.funded': 'Receive funds',
        'landing.footer': '© 2026 OryxenTech. All rights reserved.',

        'auth.login.title': 'Welcome back',
        'auth.login.subtitle': 'Sign in to continue',
        'auth.login.cta': 'Sign in',
        'auth.login.noAccount': "Don't have an account?",
        'auth.login.signup': 'Create account',
        'auth.login.forgot': 'Forgot password?',
        'auth.register.title': 'Create account',
        'auth.register.subtitle': 'Open your secure loan profile',
        'auth.register.cta': 'Create account',
        'auth.register.haveAccount': 'Already have an account?',
        'auth.register.signin': 'Sign in',
        'auth.forgot.title': 'Reset password',
        'auth.forgot.subtitle': 'We will email you reset instructions',
        'auth.forgot.cta': 'Send reset link',
        'auth.reset.sent': 'Check your email for password reset instructions.',
        'auth.error.credentials': 'Invalid credentials. Please try again.',
        'auth.error.passwordMismatch': 'Passwords do not match',
        'auth.error.passwordLength': 'Password must be at least 8 characters',
        'auth.error.inactive': 'Your account is currently {status}. Contact support.',
        'auth.error.roleMissing': 'We could not verify your permissions. Please sign out and sign in again.',

        'field.fullName': 'Full name',
        'field.email': 'Email',
        'field.phone': 'Phone number',
        'field.dob': 'Date of birth',
        'field.password': 'Password',
        'field.confirmPassword': 'Confirm password',
        'field.idType': 'ID type',
        'field.idNumber': 'ID number',
        'field.idExpiry': 'ID expiry date',
        'field.address': 'Address',
        'field.city': 'City',
        'field.postalCode': 'Postal code',
        'field.country': 'Country',
        'field.amount': 'Amount',
        'field.term': 'Term (months)',
        'field.purpose': 'Purpose',
        'field.description': 'Description',
        'field.estimatedValue': 'Estimated value (cents)',
        'field.paymentReference': 'Payment reference',
        'field.paymentMethod': 'Payment method',
        'field.interestRate': 'Interest rate',

        'customer.welcome': 'Welcome back, {name}',
        'customer.subtitle': 'Manage collateral-backed loans with full transparency.',
        'customer.quick.identity': 'Verify identity',
        'customer.quick.loan': 'New loan',
        'customer.quick.payment': 'Make payment',
        'customer.quick.loyalty': 'Loyalty',
        'customer.activeLoans': 'Active loans',
        'customer.noActiveLoans': 'No active loans yet. Start a request to see it here.',
        'customer.recentActivity': 'Recent activity',
        'customer.noActivity': 'No activity recorded.',

        'kyc.title': 'Verify your identity',
        'kyc.subtitle': 'Submit KYC information to unlock loan requests.',
        'kyc.submit': 'Submit verification',
        'kyc.success': 'KYC data submitted. We will review shortly.',
        'kyc.id.passport': 'Passport',
        'kyc.id.national': 'National ID',
        'kyc.id.drivers': 'Driver license',

        'loan.new.title': 'Simulate and request a loan',
        'loan.new.subtitle': 'All amounts are stored in integer cents for accuracy.',
        'loan.new.simulation': 'Simulation',
        'loan.new.monthlyPayment': 'Estimated monthly payment',
        'loan.new.totalCost': 'Total repayment',
        'loan.new.submit': 'Submit loan request',
        'loan.new.success': 'Loan request submitted for review.',
        'loan.new.optionalCollateral': 'Optional: link existing collateral',
        'loan.new.termRange': 'Allowed term: {min}-{max} months',
        'loan.new.amountRange': 'Allowed amount: {min} to {max}',

        'collateral.title': 'Register collateral',
        'collateral.subtitle': 'Describe your device or asset. Photos are optional when uploads are disabled.',
        'collateral.submit': 'Submit collateral',
        'collateral.success': 'Collateral registered and pending appraisal.',
        'collateral.type.vehicle': 'Vehicle',
        'collateral.type.property': 'Property',
        'collateral.type.jewelry': 'Jewelry',
        'collateral.type.electronics': 'Electronics',
        'collateral.type.other': 'Other',

        'loans.list.title': 'Your loans',
        'loans.list.empty': 'No loans found.',
        'loans.details.title': 'Loan details',
        'loans.details.balance': 'Remaining balance',
        'loans.details.status': 'Status',
        'loans.details.payments': 'Payments',

        'payments.title': 'Submit a payment',
        'payments.subtitle': 'Provide payment proof reference. Uploads remain disabled by default.',
        'payments.submit': 'Submit payment',
        'payments.success': 'Payment submitted for confirmation.',
        'payments.confirmedBy': 'Confirmed by',
        'payments.selectLoan': 'Select a loan',
        'payments.proofFileOptional': 'Proof file (optional)',
        'payments.referenceLabel': 'Reference',
        'payments.method.bank_transfer': 'Bank transfer',
        'payments.method.cash': 'Cash',
        'payments.method.card': 'Card',
        'payments.method.mobile_money': 'Mobile money',

        'contract.title': 'Contract & consent',
        'contract.description': 'Review obligations for collateral-backed lending.',
        'contract.point1': 'All disbursements are backed by submitted collateral.',
        'contract.point2': 'Payments are recorded with immutable audit trails.',
        'contract.point3': 'Interest is calculated on the agreed annual rate.',
        'contract.point4': 'Late or missing payments may lead to collateral liquidation.',
        'contract.signatureLabel': 'Type your full legal name to sign',
        'contract.signCta': 'Sign & acknowledge',
        'contract.signed': 'Signature recorded locally for this session: {signature}',

        'loyalty.title': 'Loyalty status',
        'loyalty.subtitle': 'Earn better rates with on-time payments.',
        'loyalty.tier': 'Tier',
        'loyalty.points': 'Points',
        'loyalty.nextTier': 'Next tier at',

        'help.title': 'Help & guidance',
        'help.contact': 'Need help? Contact support.',
        'help.faq.eligibility.q': 'Who can request a loan?',
        'help.faq.eligibility.a': 'Registered customers who complete KYC and provide acceptable collateral.',
        'help.faq.payments.q': 'How do I confirm a payment?',
        'help.faq.payments.a': 'Submit payment reference; admins will review and confirm.',
        'help.faq.uploads.q': 'Why are uploads disabled?',
        'help.faq.uploads.a': 'Storage is locked by default. Enable it only after reviewing security rules.',

        'admin.dashboard.title': 'Admin dashboard',
        'admin.dashboard.subtitle': 'Review requests, manage loans, and enforce controls.',
        'admin.requests.title': 'Loan requests',
        'admin.requests.subtitle': 'Pending and in-review requests',
        'admin.requests.empty': 'No requests yet.',
        'admin.requests.pending': 'Pending',
        'admin.requests.review': 'Review',
        'admin.requestDetails.title': 'Request details',
        'admin.requestDetails.approve': 'Approve and create loan',
        'admin.requestDetails.reject': 'Reject request',
        'admin.requestDetails.rejectionReason': 'Rejection reason',
        'admin.requestDetails.success': 'Decision recorded and audit log created.',

        'admin.loans.title': 'All loans',
        'admin.loans.subtitle': 'Portfolio overview',
        'admin.loans.empty': 'No loans to display.',
        'admin.loanDetails.title': 'Manage loan',
        'admin.loanDetails.confirmPayment': 'Confirm payment',
        'admin.loanDetails.rejectPayment': 'Reject payment',

        'admin.settings.title': 'Business settings',
        'admin.settings.subtitle': 'Configure safe operating limits.',
        'admin.settings.save': 'Update settings',
        'admin.settings.success': 'Settings updated.',
        'admin.settings.maintenance': 'Maintenance mode',
        'admin.settings.maxAmount': 'Max loan amount (cents)',
        'admin.settings.minAmount': 'Min loan amount (cents)',
        'admin.settings.maxTerm': 'Max term (months)',
        'admin.settings.minTerm': 'Min term (months)',

        'admin.audit.title': 'Audit log',
        'admin.audit.subtitle': 'Immutable record of admin actions.',
        'admin.audit.empty': 'No audit entries yet.',
    },
    es: {
        'common.appName': 'Préstamos con Garantía OryxenTech',
        'common.shortName': 'OryxenTech',
        'common.languageLabel': 'Idioma',
        'common.logout': 'Cerrar sesión',
        'common.loading': 'Cargando...',
        'common.save': 'Guardar',
        'common.cancel': 'Cancelar',
        'common.submit': 'Enviar',
        'common.approve': 'Aprobar',
        'common.reject': 'Rechazar',
        'common.view': 'Ver',
        'common.error.generic': 'Algo salió mal. Intenta nuevamente.',
        'common.storage.disabled': 'Las cargas están deshabilitadas. Proporciona evidencia en texto.',
        'common.status.active': 'Activa',
        'common.status.pending': 'Pendiente',
        'common.status.rejected': 'Rechazada',
        'common.status.approved': 'Aprobada',
        'common.status.submitted': 'Enviada',
        'common.status.confirmed': 'Confirmada',
        'common.status.underReview': 'En revisión',
        'nav.dashboard': 'Tablero',
        'nav.identity': 'Identidad',
        'nav.collateral': 'Garantía',
        'nav.loans': 'Préstamos',
        'nav.payments': 'Pagos',
        'nav.help': 'Ayuda',
        'nav.requests': 'Solicitudes',
        'nav.settings': 'Ajustes',
        'nav.audit': 'Auditoría',
        'nav.admin': 'Admin',
        'nav.customer': 'Cliente',

        'landing.title': 'Préstamos rápidos y seguros con garantía física',
        'landing.subtitle':
            'Solicita financiamiento a corto plazo dejando dispositivos aprobados como garantía. Transparente, auditable y seguro.',
        'landing.cta.apply': 'Solicitar ahora',
        'landing.cta.login': 'Ingresar',
        'landing.feature.fast': 'Revisión rápida en menos de 24 horas',
        'landing.feature.secure': 'Seguridad bancaria y trazabilidad clara',
        'landing.feature.rates': 'Tasas competitivas y planes claros',
        'landing.step.register': 'Registrarse',
        'landing.step.kyc': 'Verificar identidad',
        'landing.step.request': 'Solicitar préstamo',
        'landing.step.funded': 'Recibir fondos',
        'landing.footer': '© 2026 OryxenTech. Todos los derechos reservados.',

        'auth.login.title': 'Bienvenido de nuevo',
        'auth.login.subtitle': 'Inicia sesión para continuar',
        'auth.login.cta': 'Iniciar sesión',
        'auth.login.noAccount': '¿No tienes cuenta?',
        'auth.login.signup': 'Crear cuenta',
        'auth.login.forgot': '¿Olvidaste tu contraseña?',
        'auth.register.title': 'Crear cuenta',
        'auth.register.subtitle': 'Abre tu perfil seguro de préstamos',
        'auth.register.cta': 'Crear cuenta',
        'auth.register.haveAccount': '¿Ya tienes cuenta?',
        'auth.register.signin': 'Inicia sesión',
        'auth.forgot.title': 'Restablecer contraseña',
        'auth.forgot.subtitle': 'Te enviaremos instrucciones por correo',
        'auth.forgot.cta': 'Enviar enlace',
        'auth.reset.sent': 'Revisa tu correo para las instrucciones de restablecimiento.',
        'auth.error.credentials': 'Credenciales inválidas. Intenta nuevamente.',
        'auth.error.passwordMismatch': 'Las contraseñas no coinciden',
        'auth.error.passwordLength': 'La contraseña debe tener al menos 8 caracteres',
        'auth.error.inactive': 'Tu cuenta está {status}. Contacta a soporte.',
        'auth.error.roleMissing': 'No pudimos verificar tus permisos. Cierra sesión y vuelve a ingresar.',

        'field.fullName': 'Nombre completo',
        'field.email': 'Correo electrónico',
        'field.phone': 'Número de teléfono',
        'field.dob': 'Fecha de nacimiento',
        'field.password': 'Contraseña',
        'field.confirmPassword': 'Confirmar contraseña',
        'field.idType': 'Tipo de documento',
        'field.idNumber': 'Número de documento',
        'field.idExpiry': 'Fecha de vencimiento',
        'field.address': 'Dirección',
        'field.city': 'Ciudad',
        'field.postalCode': 'Código postal',
        'field.country': 'País',
        'field.amount': 'Monto',
        'field.term': 'Plazo (meses)',
        'field.purpose': 'Propósito',
        'field.description': 'Descripción',
        'field.estimatedValue': 'Valor estimado (centavos)',
        'field.paymentReference': 'Referencia de pago',
        'field.paymentMethod': 'Método de pago',
        'field.interestRate': 'Tasa de interés',

        'customer.welcome': 'Bienvenido, {name}',
        'customer.subtitle': 'Administra préstamos con garantía con total transparencia.',
        'customer.quick.identity': 'Verificar identidad',
        'customer.quick.loan': 'Nuevo préstamo',
        'customer.quick.payment': 'Registrar pago',
        'customer.quick.loyalty': 'Lealtad',
        'customer.activeLoans': 'Préstamos activos',
        'customer.noActiveLoans': 'Aún no tienes préstamos activos. Inicia una solicitud.',
        'customer.recentActivity': 'Actividad reciente',
        'customer.noActivity': 'Sin actividad registrada.',

        'kyc.title': 'Verifica tu identidad',
        'kyc.subtitle': 'Envía la información KYC para habilitar solicitudes.',
        'kyc.submit': 'Enviar verificación',
        'kyc.success': 'Datos KYC enviados. Revisaremos pronto.',
        'kyc.id.passport': 'Pasaporte',
        'kyc.id.national': 'Documento nacional',
        'kyc.id.drivers': 'Licencia de conducir',

        'loan.new.title': 'Simula y solicita un préstamo',
        'loan.new.subtitle': 'Todos los montos se almacenan en centavos enteros.',
        'loan.new.simulation': 'Simulación',
        'loan.new.monthlyPayment': 'Pago mensual estimado',
        'loan.new.totalCost': 'Pago total',
        'loan.new.submit': 'Enviar solicitud',
        'loan.new.success': 'Solicitud enviada para revisión.',
        'loan.new.optionalCollateral': 'Opcional: vincula una garantía existente',
        'loan.new.termRange': 'Plazo permitido: {min}-{max} meses',
        'loan.new.amountRange': 'Monto permitido: {min} a {max}',

        'collateral.title': 'Registrar garantía',
        'collateral.subtitle': 'Describe tu activo. Las fotos son opcionales mientras las cargas estén desactivadas.',
        'collateral.submit': 'Registrar garantía',
        'collateral.success': 'Garantía registrada y pendiente de avalúo.',
        'collateral.type.vehicle': 'Vehículo',
        'collateral.type.property': 'Propiedad',
        'collateral.type.jewelry': 'Joyería',
        'collateral.type.electronics': 'Electrónica',
        'collateral.type.other': 'Otra',

        'loans.list.title': 'Tus préstamos',
        'loans.list.empty': 'No se encontraron préstamos.',
        'loans.details.title': 'Detalle del préstamo',
        'loans.details.balance': 'Saldo restante',
        'loans.details.status': 'Estado',
        'loans.details.payments': 'Pagos',

        'payments.title': 'Registrar un pago',
        'payments.subtitle': 'Proporciona la referencia del pago. Las cargas siguen desactivadas por defecto.',
        'payments.submit': 'Enviar pago',
        'payments.success': 'Pago enviado para confirmación.',
        'payments.confirmedBy': 'Confirmado por',
        'payments.selectLoan': 'Selecciona un préstamo',
        'payments.proofFileOptional': 'Archivo de soporte (opcional)',
        'payments.referenceLabel': 'Referencia',
        'payments.method.bank_transfer': 'Transferencia bancaria',
        'payments.method.cash': 'Efectivo',
        'payments.method.card': 'Tarjeta',
        'payments.method.mobile_money': 'Dinero móvil',

        'contract.title': 'Contrato y consentimiento',
        'contract.description': 'Revisa las obligaciones de los préstamos con garantía.',
        'contract.point1': 'Todos los desembolsos están respaldados por la garantía enviada.',
        'contract.point2': 'Los pagos se registran con bitácoras inmutables.',
        'contract.point3': 'El interés se calcula con la tasa anual acordada.',
        'contract.point4': 'Pagos tardíos o faltantes pueden llevar a liquidar la garantía.',
        'contract.signatureLabel': 'Escribe tu nombre completo para firmar',
        'contract.signCta': 'Firmar y aceptar',
        'contract.signed': 'Firma guardada localmente para esta sesión: {signature}',

        'loyalty.title': 'Estado de lealtad',
        'loyalty.subtitle': 'Obtén mejores tasas pagando a tiempo.',
        'loyalty.tier': 'Nivel',
        'loyalty.points': 'Puntos',
        'loyalty.nextTier': 'Siguiente nivel en',

        'help.title': 'Ayuda y guía',
        'help.contact': '¿Necesitas ayuda? Contacta soporte.',
        'help.faq.eligibility.q': '¿Quién puede solicitar un préstamo?',
        'help.faq.eligibility.a': 'Clientes registrados que completen KYC y ofrezcan garantías aceptables.',
        'help.faq.payments.q': '¿Cómo se confirma un pago?',
        'help.faq.payments.a': 'Envía la referencia de pago; un administrador la revisará y confirmará.',
        'help.faq.uploads.q': '¿Por qué las cargas están desactivadas?',
        'help.faq.uploads.a': 'El almacenamiento está bloqueado por seguridad. Actívalo solo tras revisar las reglas.',

        'admin.dashboard.title': 'Panel de administración',
        'admin.dashboard.subtitle': 'Revisa solicitudes, gestiona préstamos y controles.',
        'admin.requests.title': 'Solicitudes de préstamo',
        'admin.requests.subtitle': 'Solicitudes pendientes y en revisión',
        'admin.requests.empty': 'Aún no hay solicitudes.',
        'admin.requests.pending': 'Pendiente',
        'admin.requests.review': 'Revisar',
        'admin.requestDetails.title': 'Detalle de solicitud',
        'admin.requestDetails.approve': 'Aprobar y crear préstamo',
        'admin.requestDetails.reject': 'Rechazar solicitud',
        'admin.requestDetails.rejectionReason': 'Motivo de rechazo',
        'admin.requestDetails.success': 'Decisión registrada y auditada.',

        'admin.loans.title': 'Todos los préstamos',
        'admin.loans.subtitle': 'Resumen de cartera',
        'admin.loans.empty': 'No hay préstamos que mostrar.',
        'admin.loanDetails.title': 'Gestionar préstamo',
        'admin.loanDetails.confirmPayment': 'Confirmar pago',
        'admin.loanDetails.rejectPayment': 'Rechazar pago',

        'admin.settings.title': 'Configuración del negocio',
        'admin.settings.subtitle': 'Define límites operativos seguros.',
        'admin.settings.save': 'Actualizar configuración',
        'admin.settings.success': 'Configuración actualizada.',
        'admin.settings.maintenance': 'Modo de mantenimiento',
        'admin.settings.maxAmount': 'Monto máximo del préstamo (centavos)',
        'admin.settings.minAmount': 'Monto mínimo del préstamo (centavos)',
        'admin.settings.maxTerm': 'Plazo máximo (meses)',
        'admin.settings.minTerm': 'Plazo mínimo (meses)',

        'admin.audit.title': 'Bitácora de auditoría',
        'admin.audit.subtitle': 'Registro inmutable de acciones administrativas.',
        'admin.audit.empty': 'Sin registros aún.',
    },
    fr: {
        'common.appName': 'Prêts avec Garantie OryxenTech',
        'common.shortName': 'OryxenTech',
        'common.languageLabel': 'Langue',
        'common.logout': 'Se déconnecter',
        'common.loading': 'Chargement...',
        'common.save': 'Enregistrer',
        'common.cancel': 'Annuler',
        'common.submit': 'Envoyer',
        'common.approve': 'Approuver',
        'common.reject': 'Rejeter',
        'common.view': 'Voir',
        'common.error.generic': 'Une erreur est survenue. Réessayez.',
        'common.storage.disabled': "Les téléversements sont désactivés. Fournissez une preuve textuelle à la place.",
        'common.status.active': 'Actif',
        'common.status.pending': 'En attente',
        'common.status.rejected': 'Rejeté',
        'common.status.approved': 'Approuvé',
        'common.status.submitted': 'Envoyé',
        'common.status.confirmed': 'Confirmé',
        'common.status.underReview': 'En cours de revue',
        'nav.dashboard': 'Tableau de bord',
        'nav.identity': 'Identité',
        'nav.collateral': 'Garantie',
        'nav.loans': 'Prêts',
        'nav.payments': 'Paiements',
        'nav.help': 'Aide',
        'nav.requests': 'Demandes',
        'nav.settings': 'Paramètres',
        'nav.audit': 'Audit',
        'nav.admin': 'Admin',
        'nav.customer': 'Client',

        'landing.title': 'Prêts rapides et sécurisés avec garantie physique',
        'landing.subtitle':
            'Demandez un financement court terme en déposant des appareils approuvés comme garantie. Transparent, auditable et sûr.',
        'landing.cta.apply': 'Demander maintenant',
        'landing.cta.login': 'Connexion',
        'landing.feature.fast': 'Revue rapide en moins de 24 h',
        'landing.feature.secure': 'Sécurité bancaire et traçabilité claire',
        'landing.feature.rates': 'Taux compétitifs et plans limpides',
        'landing.step.register': "S'inscrire",
        'landing.step.kyc': "Vérifier l'identité",
        'landing.step.request': 'Demander un prêt',
        'landing.step.funded': 'Recevoir les fonds',
        'landing.footer': '© 2026 OryxenTech. Tous droits réservés.',

        'auth.login.title': 'Content de vous revoir',
        'auth.login.subtitle': 'Connectez-vous pour continuer',
        'auth.login.cta': 'Se connecter',
        'auth.login.noAccount': "Pas encore de compte ?",
        'auth.login.signup': 'Créer un compte',
        'auth.login.forgot': 'Mot de passe oublié ?',
        'auth.register.title': 'Créer un compte',
        'auth.register.subtitle': 'Ouvrez votre profil de prêt sécurisé',
        'auth.register.cta': 'Créer un compte',
        'auth.register.haveAccount': 'Vous avez déjà un compte ?',
        'auth.register.signin': 'Se connecter',
        'auth.forgot.title': 'Réinitialiser le mot de passe',
        'auth.forgot.subtitle': 'Nous vous enverrons des instructions par e-mail',
        'auth.forgot.cta': 'Envoyer le lien',
        'auth.reset.sent': 'Vérifiez votre email pour les instructions.',
        'auth.error.credentials': 'Identifiants invalides. Réessayez.',
        'auth.error.passwordMismatch': 'Les mots de passe ne correspondent pas',
        'auth.error.passwordLength': 'Le mot de passe doit contenir au moins 8 caractères',
        'auth.error.inactive': 'Votre compte est actuellement {status}. Contactez le support.',
        'auth.error.roleMissing':
            'Nous ne pouvons pas vérifier vos permissions. Déconnectez-vous puis reconnectez-vous.',

        'field.fullName': 'Nom complet',
        'field.email': 'Email',
        'field.phone': 'Téléphone',
        'field.dob': 'Date de naissance',
        'field.password': 'Mot de passe',
        'field.confirmPassword': 'Confirmer le mot de passe',
        'field.idType': "Type d'identité",
        'field.idNumber': "Numéro d'identité",
        'field.idExpiry': "Date d'expiration",
        'field.address': 'Adresse',
        'field.city': 'Ville',
        'field.postalCode': 'Code postal',
        'field.country': 'Pays',
        'field.amount': 'Montant',
        'field.term': 'Durée (mois)',
        'field.purpose': 'Objet',
        'field.description': 'Description',
        'field.estimatedValue': 'Valeur estimée (centimes)',
        'field.paymentReference': 'Référence de paiement',
        'field.paymentMethod': 'Méthode de paiement',
        'field.interestRate': "Taux d'intérêt",

        'customer.welcome': 'Bienvenue, {name}',
        'customer.subtitle': 'Gérez des prêts garantis avec une transparence totale.',
        'customer.quick.identity': "Vérifier l'identité",
        'customer.quick.loan': 'Nouveau prêt',
        'customer.quick.payment': 'Enregistrer un paiement',
        'customer.quick.loyalty': 'Fidélité',
        'customer.activeLoans': 'Prêts actifs',
        'customer.noActiveLoans': "Aucun prêt actif. Commencez une demande pour l'afficher ici.",
        'customer.recentActivity': 'Activité récente',
        'customer.noActivity': 'Aucune activité enregistrée.',

        'kyc.title': "Vérifiez votre identité",
        'kyc.subtitle': 'Soumettez les informations KYC pour activer vos demandes.',
        'kyc.submit': 'Envoyer la vérification',
        'kyc.success': 'Données KYC envoyées. Nous les examinerons vite.',
        'kyc.id.passport': 'Passeport',
        'kyc.id.national': "Carte d'identité",
        'kyc.id.drivers': 'Permis de conduire',

        'loan.new.title': 'Simuler et demander un prêt',
        'loan.new.subtitle': 'Tous les montants sont stockés en centimes entiers.',
        'loan.new.simulation': 'Simulation',
        'loan.new.monthlyPayment': 'Paiement mensuel estimé',
        'loan.new.totalCost': 'Remboursement total',
        'loan.new.submit': 'Envoyer la demande',
        'loan.new.success': 'Demande envoyée pour revue.',
        'loan.new.optionalCollateral': 'Optionnel : lier une garantie existante',
        'loan.new.termRange': 'Durée autorisée : {min}-{max} mois',
        'loan.new.amountRange': 'Montant autorisé : {min} à {max}',

        'collateral.title': 'Enregistrer une garantie',
        'collateral.subtitle':
            'Décrivez votre actif. Les photos sont optionnelles tant que les téléversements sont désactivés.',
        'collateral.submit': 'Enregistrer la garantie',
        'collateral.success': 'Garantie enregistrée et en attente d’évaluation.',
        'collateral.type.vehicle': 'Véhicule',
        'collateral.type.property': 'Propriété',
        'collateral.type.jewelry': 'Bijoux',
        'collateral.type.electronics': 'Électronique',
        'collateral.type.other': 'Autre',

        'loans.list.title': 'Vos prêts',
        'loans.list.empty': 'Aucun prêt trouvé.',
        'loans.details.title': 'Détails du prêt',
        'loans.details.balance': 'Solde restant',
        'loans.details.status': 'Statut',
        'loans.details.payments': 'Paiements',

        'payments.title': 'Enregistrer un paiement',
        'payments.subtitle': 'Fournissez la référence du paiement. Les téléversements restent désactivés par défaut.',
        'payments.submit': 'Envoyer le paiement',
        'payments.success': 'Paiement envoyé pour confirmation.',
        'payments.confirmedBy': 'Confirmé par',
        'payments.selectLoan': 'Sélectionnez un prêt',
        'payments.proofFileOptional': 'Fichier justificatif (optionnel)',
        'payments.referenceLabel': 'Référence',
        'payments.method.bank_transfer': 'Virement bancaire',
        'payments.method.cash': 'Espèces',
        'payments.method.card': 'Carte',
        'payments.method.mobile_money': 'Mobile money',

        'contract.title': 'Contrat et consentement',
        'contract.description': 'Passez en revue les obligations du prêt garanti.',
        'contract.point1': 'Tous les décaissements sont garantis par le dépôt.',
        'contract.point2': "Les paiements sont journalisés de façon immuable.",
        'contract.point3': "Les intérêts sont calculés au taux annuel convenu.",
        'contract.point4': 'Les retards peuvent conduire à la liquidation de la garantie.',
        'contract.signatureLabel': 'Tapez votre nom complet pour signer',
        'contract.signCta': 'Signer et accepter',
        'contract.signed': 'Signature enregistrée localement pour cette session : {signature}',

        'loyalty.title': 'Statut de fidélité',
        'loyalty.subtitle': 'Obtenez de meilleurs taux avec des paiements ponctuels.',
        'loyalty.tier': 'Niveau',
        'loyalty.points': 'Points',
        'loyalty.nextTier': 'Prochain niveau à',

        'help.title': 'Aide et guide',
        'help.contact': "Besoin d'aide ? Contactez le support.",
        'help.faq.eligibility.q': 'Qui peut demander un prêt ?',
        'help.faq.eligibility.a': 'Les clients inscrits ayant complété le KYC et fourni une garantie acceptable.',
        'help.faq.payments.q': 'Comment confirmer un paiement ?',
        'help.faq.payments.a': 'Envoyez la référence de paiement ; un administrateur la vérifiera.',
        'help.faq.uploads.q': 'Pourquoi les téléversements sont-ils désactivés ?',
        'help.faq.uploads.a':
            "Le stockage est verrouillé par sécurité. Activez-le uniquement après avoir revu les règles.",

        'admin.dashboard.title': "Tableau d'administration",
        'admin.dashboard.subtitle': 'Revoir les demandes, gérer les prêts et appliquer les contrôles.',
        'admin.requests.title': 'Demandes de prêt',
        'admin.requests.subtitle': 'Demandes en attente et en revue',
        'admin.requests.empty': 'Aucune demande pour le moment.',
        'admin.requests.pending': 'En attente',
        'admin.requests.review': 'Revoir',
        'admin.requestDetails.title': 'Détail de la demande',
        'admin.requestDetails.approve': 'Approuver et créer le prêt',
        'admin.requestDetails.reject': 'Rejeter la demande',
        'admin.requestDetails.rejectionReason': 'Motif du rejet',
        'admin.requestDetails.success': 'Décision enregistrée et auditée.',

        'admin.loans.title': 'Tous les prêts',
        'admin.loans.subtitle': 'Vue du portefeuille',
        'admin.loans.empty': 'Aucun prêt à afficher.',
        'admin.loanDetails.title': 'Gérer le prêt',
        'admin.loanDetails.confirmPayment': 'Confirmer le paiement',
        'admin.loanDetails.rejectPayment': 'Rejeter le paiement',

        'admin.settings.title': "Paramètres d'exploitation",
        'admin.settings.subtitle': 'Définissez des limites sûres.',
        'admin.settings.save': 'Mettre à jour',
        'admin.settings.success': 'Paramètres mis à jour.',
        'admin.settings.maintenance': 'Mode maintenance',
        'admin.settings.maxAmount': 'Montant maximal du prêt (centimes)',
        'admin.settings.minAmount': 'Montant minimal du prêt (centimes)',
        'admin.settings.maxTerm': 'Durée maximale (mois)',
        'admin.settings.minTerm': 'Durée minimale (mois)',

        'admin.audit.title': "Journal d'audit",
        'admin.audit.subtitle': 'Enregistrement immuable des actions administratives.',
        'admin.audit.empty': 'Aucune entrée pour le moment.',
    },
};

interface I18nContextValue {
    locale: Locale;
    setLocale: (locale: Locale) => void;
    t: (key: string, params?: Record<string, string | number>) => string;
}

const I18nContext = createContext<I18nContextValue | undefined>(undefined);

function interpolate(template: string, params?: Record<string, string | number>) {
    if (!params) return template;
    return Object.entries(params).reduce((acc, [key, value]) => {
        return acc.replace(`{${key}}`, String(value));
    }, template);
}

export function I18nProvider({ children }: { children: React.ReactNode }) {
    const storage =
        typeof window !== 'undefined' &&
        typeof window.localStorage !== 'undefined' &&
        typeof window.localStorage.getItem === 'function' &&
        typeof window.localStorage.setItem === 'function'
            ? window.localStorage
            : null;

    const [locale, setLocaleState] = useState<Locale>(() => {
        const stored = storage ? storage.getItem('locale') : null;
        if (stored === 'es' || stored === 'fr' || stored === 'en') return stored;
        return 'en';
    });

    useEffect(() => {
        if (storage) {
            storage.setItem('locale', locale);
        }
    }, [locale, storage]);

    const value = useMemo<I18nContextValue>(() => {
        const translate = (key: string, params?: Record<string, string | number>) => {
            const localized = translations[locale][key];
            const fallback = translations.en[key];
            return interpolate(localized || fallback || key, params);
        };

        return {
            locale,
            setLocale: (newLocale: Locale) => setLocaleState(newLocale),
            t: translate,
        };
    }, [locale]);

    return <I18nContext.Provider value={value}>{children}</I18nContext.Provider>;
}

export function useI18n() {
    const context = useContext(I18nContext);
    if (!context) {
        throw new Error('useI18n must be used within I18nProvider');
    }
    return context;
}
